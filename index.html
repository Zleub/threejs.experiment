<html>
<head>
	<title>My first Three.js app</title>
	<style>
		body { margin: 0; }
		canvas { width: 100%; height: 100% }
	</style>
</head>
<body>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r69/three.min.js"></script>
	<script src="keys.js"></script>
	<script>
		function log(object) { console.log(object) }
		function print(object) { console.log(object) }

		var objects = []

		var scene = new THREE.Scene()
		var camera = new THREE.PerspectiveCamera( 75, window.innerWidth/window.innerHeight, 0.1, 1000 )

		var renderer = new THREE.WebGLRenderer()
		renderer.setSize( window.innerWidth, window.innerHeight )
		document.body.appendChild( renderer.domElement )

		var geometry = new THREE.BoxGeometry(1, 1, 1)

		function add_box(offx, offy, offz)
		{
			var s = new THREE.Mesh( geometry , new THREE.MeshBasicMaterial({color: '#DDDDDD', wireframe: true}));
			s.position.x = offx
			s.position.y = offy
			s.position.z = offz
			scene.add( s )
			objects.push(s)
		}

		function make_matricial_scene(x, y, z)
		{
			for (var i = -x; i < x; i++)
				for (var j = -y; j < y; j++)
					for (var k = -z; k < z; k++)
						add_box(i, j, k)
		}

		function make_matricial_scene_2d(x, y)
		{
			for (var i = -x; i < x; i++)
				for (var j = -y; j < y; j++)
					add_box(i, j, 0)
		}


		// make_matricial_scene(5, 3, 3)
		add_box(-0.5, 1, 0)
		add_box(0.5, 1, 0)
		add_box(-1.5, 1, 0)
		add_box(1.5, 1, 0)
		add_box(-0.5, 0, 0)
		add_box(0.5, 0, 0)
		add_box(-1.5, 0, 0)
		add_box(1.5, 0, 0)
		add_box(-0.5, -1, 0)
		add_box(0.5, -1, 0)
		add_box(-0.5, -2, 0)
		add_box(0.5, -2, 0)

		// var test1 = new THREE.Geometry();
		// test1.vertices.push(
		// 	new THREE.Vector3( -2, 1.5, 0.5 ),
		// 	new THREE.Vector3( -2, -0.5, 0.5 ),
		// 	new THREE.Vector3( 2, -0.5, 0.5 ),
		// 	new THREE.Vector3( 2, 1.5, 0.5)
		// );

		// test1.faces.push( new THREE.Face3( 0, 1, 2 ) );
		// test1.faces.push( new THREE.Face3( 3, 0, 2 ) );

		// scene.add(new THREE.Mesh(test1, new THREE.MeshBasicMaterial({color: '#DDDDDD'})))

		// var test2 = new THREE.Geometry();
		// test2.vertices.push(
		// 	new THREE.Vector3( -2, 1.5, -0.5 ),
		// 	new THREE.Vector3( -2, -0.5, -0.5 ),
		// 	new THREE.Vector3( 2, -0.5, -0.5 ),
		// 	new THREE.Vector3( 2, 1.5, -0.5)
		// );

		// test2.faces.push( new THREE.Face3( 1, 0, 2 ) );
		// test2.faces.push( new THREE.Face3( 0, 3, 2 ) );

		// scene.add(new THREE.Mesh(test2, new THREE.MeshBasicMaterial({color: '#DDDDDD'})))

		log(camera)


		function mousemove(event) {
			var raycaster = new THREE.Raycaster(
				camera.position,
				new THREE.Vector3(0, 0, 0)
			)
			var vector = new THREE.Vector3();

			vector.set( ( event.clientX / window.innerWidth ) * 2 - 1, - ( event.clientY / window.innerHeight ) * 2 + 1, 0.5 );
			vector.unproject( camera );

			raycaster.ray.set( camera.position, vector.sub( camera.position ).normalize() );
			// log('Direction: ')
			// log(raycaster.ray.direction)
			// log('Origin: ')
			// log(raycaster.ray.origin)
			log(raycaster.intersectObjects(objects, false))
		}

		camera.position.z = 5;

		var render = function () {
			requestAnimationFrame( render )
			renderer.render(scene, camera)
		};

	window.addEventListener("keypress", keypressed, false)
	window.addEventListener("keydown", keydown, false)
	window.addEventListener("keyup", keyup, false)
	window.addEventListener('mousemove', mousemove, false)

	log(objects)

	render()
</script>
</body>
</html>
